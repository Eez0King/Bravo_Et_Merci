/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var n={58394:function(n,e,t){"use strict";n.exports=t.p+"57555275bcdb0b38d4b9.css"},60947:function(n,e,t){"use strict";n.exports=t.p+"1b1006d9aa8d8b6f0f11.js"}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return n[r](i,i.exports,t),i.exports}t.m=n,t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),t.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},function(){var n;t.g.importScripts&&(n=t.g.location+"");var e=t.g.document;if(!n&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(n=e.currentScript.src),!n)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!n||!/^http(s?):/.test(n));)n=r[o--].src}if(!n)throw new Error("Automatic publicPath is not supported in this browser");n=n.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=n}(),t.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function n(){var t,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function a(n,o,i,c){var a=o&&o.prototype instanceof u?o:u,l=Object.create(a.prototype);return e(l,"_invoke",function(n,e,o){var i,c,a,u=0,l=o||[],d=!1,f={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(n,e){return i=n,c=0,a=t,f.n=e,s}};function p(n,e){for(c=n,a=e,r=0;!d&&u&&!o&&r<l.length;r++){var o,i=l[r],p=f.p,m=i[2];n>3?(o=m===e)&&(a=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=p&&((o=n<2&&p<i[1])?(c=0,f.v=e,f.n=i[1]):p<m&&(o=n<3||i[0]>e||e>m)&&(i[4]=n,i[5]=e,f.n=m,c=0))}if(o||n>1)return s;throw d=!0,e}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,m),c=l,a=m;(r=c<2?t:a)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,a)):f.n=a:f.v=a);try{if(u=2,i){if(c||(o="next"),r=i[o]){if(!(r=r.call(i,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,c<2&&(c=0)}else 1===c&&(r=i.return)&&r.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((r=(d=f.n<0)?a:n.call(e,f))!==s)break}catch(n){i=t,c=1,a=n}finally{u=1}}return{value:r,done:d}}}(n,i,c),!0),l}var s={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(e(r={},i,function(){return this}),r),p=d.prototype=u.prototype=Object.create(f);function m(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,d):(n.__proto__=d,e(n,c,"GeneratorFunction")),n.prototype=Object.create(p),n}return l.prototype=d,e(p,"constructor",d),e(d,"constructor",l),l.displayName="GeneratorFunction",e(d,c,"GeneratorFunction"),e(p),e(p,c,"Generator"),e(p,i,function(){return this}),e(p,"toString",function(){return"[object Generator]"}),(n=function(){return{w:a,m:m}})()}function e(n,t,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}e=function(n,t,r,o){function c(t,r){e(n,t,function(n){return this._invoke(t,r,n)})}t?i?i(n,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):n[t]=r:(c("next",0),c("throw",1),c("return",2))},e(n,t,r,o)}function t(n,e,t,r,o,i,c){try{var a=n[i](c),s=a.value}catch(n){return void t(n)}a.done?e(s):Promise.resolve(s).then(r,o)}function r(n){return function(){var e=this,r=arguments;return new Promise(function(o,i){var c=n.apply(e,r);function a(n){t(c,o,i,a,s,"next",n)}function s(n){t(c,o,i,a,s,"throw",n)}a(void 0)})}}function o(n){return function(n){if(Array.isArray(n))return i(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(n){if("string"==typeof n)return i(n,e);var t={}.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(n,e):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}var c={API_URL:"http://127.0.0.1:8000/api/emails",EMAIL_REGEX:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,RH_EMAIL:"bravo-merci@entreprise.com"},a=!1;function s(n){var e;return((null===(e=document.getElementById(n))||void 0===e?void 0:e.value)||"").split(/[,;]+/).map(function(n){return n.trim()}).filter(function(n){return n})}function u(){var n,e,t=[],r=s("to"),i=s("cc"),a=s("bcc"),u=(null===(n=document.getElementById("subject"))||void 0===n?void 0:n.value.trim())||"",d=(null===(e=document.getElementById("message"))||void 0===e?void 0:e.value.trim())||"",f=l(".valeur"),p=l(".critere");r.length||t.push("Le champ 'Destinataire(s)' est obligatoire."),u||t.push("Le champ 'Objet' est obligatoire."),f.length||t.push("Veuillez sélectionner au moins une valeur reconnue."),p.length||t.push("Veuillez sélectionner au moins un critère de reconnaissance."),d||t.push("Le champ 'Message' est obligatoire.");var m=[].concat(o(r),o(i),o(a)).filter(function(n){return!function(n){return c.EMAIL_REGEX.test(n)}(n)});return m.length&&t.push("Adresse(s) email invalide(s) : ".concat(m.join(", "))),{isValid:0===t.length,errors:t,data:{to:r,cc:i,bcc:a,subject:u,message:d,valeurs:f,criteres:p}}}function l(n){return Array.from(document.querySelectorAll("".concat(n,":checked"))).map(function(n){return n.value})}function d(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],o=(new Date).toLocaleDateString("fr-FR"),i="",c="";if("undefined"!=typeof Office&&Office.context&&Office.context.mailbox){var a=Office.context.mailbox.userProfile;a&&(i=a.displayName||i,c=a.emailAddress||c)}return'\n<!doctype html>\n<html lang="fr">\n  <head>\n    <meta charset="UTF-8" />\n    <title>Bravo & Merci</title>\n  </head>\n\n  <body style="margin:0;padding:0;background-color:#fff;">\n    <div style="width:100%;padding:24px 0;background-color:#f3f2f1;">\n\n      \x3c!-- Container --\x3e\n      <div style="\n        max-width:600px;\n        margin:0 auto;\n        background-color:#ffffff;\n        border-radius:4px;\n        padding:28px;\n        font-family:Segoe UI, Arial, sans-serif;\n        color:#1f1f1f;\n      ">\n\n        \x3c!-- Header --\x3e\n        <div style="margin-bottom:24px;">\n          <img src="'.concat("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRg-Me-63CZ3XXkow-vhNX4xV_lsFk-gYIxzA&s",'" width="160" alt="SGCI" />\n        </div>\n\n        \x3c!-- Meta informations --\x3e\n        <div style="\n          font-size:13px;\n          line-height:18px;\n          color:#4a4a4a;\n          margin-bottom:24px;\n          padding-left:12px;\n          border-left:3px solid #e60028;\n        ">\n          <div><strong>Date d’envoi :</strong> ').concat(o,"</div>\n          <div><strong>Nom du nominateur :</strong> ").concat(i,"</div>\n          <div><strong>Email du nominateur :</strong> ").concat(c,'</div>\n        </div>\n\n        \x3c!-- Objet --\x3e\n        <div style="margin-bottom:20px;">\n          <div style="\n            font-size:12px;\n            text-transform:uppercase;\n            letter-spacing:0.4px;\n            color:#605e5c;\n            margin-bottom:6px;\n          ">\n            Objet\n          </div>\n          <div style="\n            font-size:17px;\n            font-weight:600;\n            line-height:22px;\n            color:#000000;\n          ">\n           ').concat(n,'\n          </div>\n        </div>\n\n        \x3c!-- Divider --\x3e\n        <div style="height:1px;background-color:#edebe9;margin:24px 0;"></div>\n\n        \x3c!-- Valeurs --\x3e\n        ').concat(t.length?'\n        <div style="margin-bottom:20px;">\n          <div style="\n            font-size:14px;\n            font-weight:600;\n            margin-bottom:8px;\n            color:#000000;\n          ">\n            Valeur Société Générale reconnue\n          </div>\n          '.concat(t.map(function(n){return'\n          <span style="\n            display:inline-block;\n            background-color:#fde7ea;\n            color:#a4001d;\n            padding:5px 12px;\n            border-radius:14px;\n            font-size:12px;\n            margin:4px 6px 0 0;\n          ">\n            '.concat(n,"\n          </span>")}).join(""),"\n        </div>"):"","\n\n        \x3c!-- Critères --\x3e\n        ").concat(r.length?'\n        <div style="margin-bottom:24px;">\n          <div style="\n            font-size:14px;\n            font-weight:600;\n            margin-bottom:8px;\n            color:#000000;\n          ">\n            Critère(s) de reconnaissance\n          </div>\n          '.concat(r.map(function(n){return'\n          <span style="\n            display:inline-block;\n            background-color:#f2f2f2;\n            color:#1f1f1f;\n            padding:5px 12px;\n            border-radius:14px;\n            font-size:12px;\n            margin:4px 6px 0 0;\n          ">\n            '.concat(n,"\n          </span>")}).join(""),"\n        </div>"):"",'\n\n        \x3c!-- Message --\x3e\n        <div style="margin-bottom:24px;">\n          <div style="\n            font-size:14px;\n            font-weight:600;\n            margin-bottom:8px;\n            color:#000000;\n          ">\n            Message de reconnaissance\n          </div>\n\n          <div style="\n            font-size:15px;\n            line-height:22px;\n            color:#1f1f1f;\n          ">\n            ').concat(e.replace(/\n/g,"<br>"),'\n          </div>\n        </div>\n\n        \x3c!-- Footer --\x3e\n        <div style="\n          border-top:1px solid #edebe9;\n          padding-top:12px;\n          font-size:11px;\n          color:#6b6b6b;\n          text-align:left;\n        ">\n          Message envoyé via le programme de reconnaissance interne SGCI.\n        </div>\n\n      </div>\n    </div>\n  </body>\n</html>\n  ')}Office.onReady(function(n){n.host!==Office.HostType.Outlook||a||(a=!0,function(){try{var n=Office.context.mailbox.userProfile,e=(null==n?void 0:n.displayName)||"Nom inconnu",t=(null==n?void 0:n.emailAddress)||"email@inconnu.com";r=e,o=t,document.getElementById("nominateur-nom").innerText=r,document.getElementById("nominateur-email").innerText=o,document.getElementById("date-envoi").innerText=(new Date).toLocaleDateString("fr-FR")}catch(n){console.error("Erreur lors du pré-remplissage:",n),w("Impossible de récupérer les informations utilisateur.")}var r,o}(),function(){var n=document.getElementById("sendBtn");if(n){var e=n.cloneNode(!0);n.parentNode.replaceChild(e,n),e.addEventListener("click",p)}document.querySelectorAll("input, textarea").forEach(function(n){n.addEventListener("input",j)})}())});var f=!1;function p(n){return m.apply(this,arguments)}function m(){return(m=r(n().m(function e(t){var r,i,a,s,l,p,m,b,y,E,R,B,O;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:if(t.preventDefault(),!f){n.n=1;break}return n.a(2);case 1:if(f=!0,j(),(r=u()).isValid){n.n=2;break}return w(r.errors.join("<br>")),f=!1,n.a(2);case 2:return A(!0),n.p=3,i=r.data,a=i.to,s=i.cc,l=i.bcc,p=i.subject,m=i.message,b=i.valeurs,y=i.criteres,E=o(l),c.RH_EMAIL&&!E.includes(c.RH_EMAIL)&&E.push(c.RH_EMAIL),htmlBody=d(p,m,b,y),R=h(a,s,E,p,m,b,y),B={toRecipients:v(a),ccRecipients:s.length?v(s):void 0,bccRecipients:E.length?v(E):void 0,subject:p,htmlBody:htmlBody},n.n=4,g(B);case 4:return n.n=5,x(R);case 5:I("Reconnaissance envoyée avec succès ! Le message a été sauvegardé."),setTimeout(function(){document.getElementById("to").value="",document.getElementById("cc").value="",document.getElementById("bcc").value="",document.getElementById("subject").value="",document.getElementById("message").value="",document.querySelectorAll(".valeur, .critere").forEach(function(n){n.checked=!1}),j(),f=!1},2e3),n.n=7;break;case 6:n.p=6,O=n.v,w("Erreur lors de l'envoi : ".concat(O.message)),f=!1;case 7:return n.p=7,A(!1),n.f(7);case 8:return n.a(2)}},e,null,[[3,6,7,8]])}))).apply(this,arguments)}function v(n){return n.map(function(n){return{emailAddress:n,displayName:n}})}function g(n){return b.apply(this,arguments)}function b(){return(b=r(n().m(function e(t){return n().w(function(n){for(;;)if(0===n.n)return n.a(2,new Promise(function(n,e){try{if("function"==typeof Office.context.mailbox.displayNewMessageForm)Office.context.mailbox.displayNewMessageForm(t),n();else if(Office.context.mailbox.item)o=t,i=Office.context.mailbox.item,o.subject&&i.subject.setAsync(o.subject),o.toRecipients&&i.to.setAsync(o.toRecipients),o.ccRecipients&&i.cc.setAsync(o.ccRecipients),o.bccRecipients&&i.bcc.setAsync(o.bccRecipients),o.htmlBody&&i.body.setAsync(o.htmlBody,{coercionType:Office.CoercionType.Html}),n();else{var r=y(t);window.open(r,"_blank"),n()}}catch(n){e(new Error("Impossible d'ouvrir le formulaire Outlook : ".concat(n.message)))}var o,i}))},e)}))).apply(this,arguments)}function y(n){var e,t,r,o=(null===(e=n.toRecipients)||void 0===e?void 0:e.map(function(n){return n.emailAddress}).join(","))||"",i="mailto:".concat(o),c=[];if(null!==(t=n.ccRecipients)&&void 0!==t&&t.length){var a=n.ccRecipients.map(function(n){return n.emailAddress}).join(",");c.push("cc=".concat(encodeURIComponent(a)))}if(null!==(r=n.bccRecipients)&&void 0!==r&&r.length){var s=n.bccRecipients.map(function(n){return n.emailAddress}).join(",");c.push("bcc=".concat(encodeURIComponent(s)))}if(n.subject&&c.push("subject=".concat(encodeURIComponent(n.subject))),n.htmlBody){var u=n.htmlBody.replace(/<[^>]*>/g,"");c.push("body=".concat(encodeURIComponent(u)))}return c.length&&(i+="?".concat(c.join("&"))),i}function h(n,e,t,r,o,i,c){var a,s;return{nominateur_nom:(null===(a=document.getElementById("nominateur-nom"))||void 0===a?void 0:a.innerText)||"",nominateur_email:(null===(s=document.getElementById("nominateur-email"))||void 0===s?void 0:s.innerText)||"",to:n,cc:e,bcc:t,subject:r,message_body:o,valeurs:i,criteres:c}}function x(n){return E.apply(this,arguments)}function E(){return(E=r(n().m(function e(t){var r,o,i,a;return n().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,n.n=1,fetch(c.API_URL,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)});case 1:if((r=n.v).ok){n.n=3;break}return n.n=2,r.json().catch(function(){return{}});case 2:throw o=n.v,new Error(o.message||"Erreur API : ".concat(r.status));case 3:return n.n=4,r.json();case 4:return i=n.v,console.log("Données sauvegardées dans la BD:",i),n.a(2,i);case 5:throw n.p=5,a=n.v,console.error("Erreur lors de la sauvegarde en BD:",a),new Error("Sauvegarde en base de données échouée : ".concat(a.message));case 6:return n.a(2)}},e,null,[[0,5]])}))).apply(this,arguments)}function w(n){var e=document.getElementById("error");e&&(e.innerHTML=n,e.scrollIntoView({behavior:"smooth",block:"nearest"}))}function I(n){var e=document.getElementById("success");e&&(e.innerText=n,e.scrollIntoView({behavior:"smooth",block:"nearest"}))}function j(){var n=document.getElementById("error"),e=document.getElementById("success");n&&(n.innerHTML=""),e&&(e.innerText="")}function A(n){var e=document.getElementById("sendBtn");e&&(n?(e.disabled=!0,e.classList.add("loading"),e.innerHTML='<span class="ms-Button-label">Envoi en cours...</span>'):(e.disabled=!1,e.classList.remove("loading"),e.innerHTML='<span class="ms-Button-label">Envoyer la reconnaissance</span>'))}}(),function(){"use strict";new URL(t(58394),t.b),new URL(t(60947),t.b)}()}();
//# sourceMappingURL=taskpane.js.map