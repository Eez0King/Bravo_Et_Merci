{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","// // Attendre que Office soit prêt\n// Office.onReady((info) => {\n//   if (info.host === Office.HostType.Outlook) {\n//     init();\n//   }\n// });\n\n// // Initialisation\n// function init() {\n//   prefillNominateur();\n//   document.getElementById(\"sendBtn\").onclick = sendMessage;\n// }\n\n// // Pré-remplir les champs du formulaire\n// function prefillNominateur() {\n//   // showDebug(\"Pre-remplissage des champs...\");\n//   const item = Office.context.mailbox.item;\n\n//   if (item && item.itemType === Office.MailboxEnums.ItemType.Message) {\n\n//     const user = Office.context.mailbox.userProfile;\n//     const displayName = user?.displayName || \"Nom inconnu\";\n//     const emailAddress = user?.emailAddress || \"email inconnu\";\n\n//     // showDebug(\"User connecté - Nom: \" + displayName + \", Email: \" + emailAddress);\n//     fillForm(displayName, emailAddress);\n//   } else {\n//     const user = Office.context.mailbox.userProfile;\n//     const displayName = user?.displayName || \"Nom inconnu\";\n//     const emailAddress = user?.emailAddress || \"email inconnu\";\n\n//     // showDebug(\"userProfile - Nom: \" + displayName + \", Email: \" + emailAddress);\n//     fillForm(displayName, emailAddress);\n//   }\n// }\n\n// // Remplit les champs du formulaire\n// function fillForm(name, email) {\n//   document.getElementById(\"nominateur-nom\").innerText = name;\n//   document.getElementById(\"nominateur-email\").innerText = email;\n//   document.getElementById(\"date-envoi\").innerText = new Date().toLocaleDateString();\n// }\n\n// const EMAIL_REGEX = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n\n// function isValidEmail(email) {\n//   return EMAIL_REGEX.test(email);\n// }\n\n// function validateEmailArray(emails, label) {\n//   const invalidEmails = emails.filter((e) => !isValidEmail(e));\n//   if (invalidEmails.length) {\n//     throw new Error(`Adresse(s) email invalide(s) dans ${label} : ${invalidEmails.join(\", \")}`);\n//   }\n// }\n\n// // Rassembler les données du formulaire\n// function buildMessageBody() {\n//   const messageTextElement = document.getElementById(\"message\");\n//   const messageText = messageTextElement ? messageTextElement.value : \"\";\n\n//   const valeurs = Array.from(document.querySelectorAll(\".valeur:checked\")).map((cb) => cb.value);\n//   const criteres = Array.from(document.querySelectorAll(\".critere:checked\")).map((cb) => cb.value);\n\n//   let body = \"\";\n\n//   if (valeurs.length) {\n//     body += `<p><strong>Valeurs reconnues :</strong> ${valeurs.join(\", \")}</p>`;\n//   }\n\n//   if (criteres.length) {\n//     body += `<p><strong>Critères :</strong> ${criteres.join(\", \")}</p>`;\n//   }\n\n//   if (messageText) {\n//     body += `<p>${messageText}</p>`;\n//   }\n\n//   return body;\n// }\n\n// // Convertir une liste d'emails en objets EmailAddressDetails\n// function toEmailAddressDetails(emails) {\n//   return emails.map((email) => {\n//     return {\n//       emailAddress: email,\n//       displayName: email,\n//     };\n//   });\n// }\n\n// // Envoi du message via le formulaire Outlook\n// async function sendMessage() {\n//   // Récupération et nettoyage des destinataires\n//   const to = document\n//     .getElementById(\"to\")\n//     .value.split(/[,;]+/)\n//     .map((e) => e.trim())\n//     .filter((e) => e);\n//   const cc = document\n//     .getElementById(\"cc\")\n//     .value.split(/[,;]+/)\n//     .map((e) => e.trim())\n//     .filter((e) => e);\n//   const bcc = document\n//     .getElementById(\"bcc\")\n//     .value.split(/[,;]+/)\n//     .map((e) => e.trim())\n//     .filter((e) => e);\n//   const subject = document.getElementById(\"subject\").value.trim();\n//   const messageBody = buildMessageBody();\n\n//   // Validation\n//   const EMAIL_REGEX = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/;\n\n// function getInvalidEmails(emails) {\n//   return emails.filter(email => !EMAIL_REGEX.test(email));\n// }\n\n//   const invalidEmails = [\n//     ...getInvalidEmails(to),\n//     ...getInvalidEmails(cc),\n//     ...getInvalidEmails(bcc),\n//   ];\n\n//   if (invalidEmails.length) {\n//     document.getElementById(\"error\").innerText =\n//       \"Adresse(s) email invalide(s) : \" + invalidEmails.join(\", \");\n//     return;\n//   }\n\n//   if (!to.length || !subject) {\n//     document.getElementById(\"error\").innerText =\n//       \"Veuillez remplir tous les champs obligatoires (destinataire et sujet).\";\n//     return;\n//   }\n\n//   // Effacer les erreurs précédentes\n//   document.getElementById(\"error\").innerText = \"\";\n\n//   try {\n//     // Envoyer à la base de données avant d'ouvrir le formulaire\n//     await saveEmail();\n//     // Préparer les paramètres du message avec le format EmailAddressDetails\n//     const messageParams = {\n//       toRecipients: toEmailAddressDetails(to),\n//       subject: subject,\n//       htmlBody: messageBody,\n//     };\n\n//     console.log(\"Tentative d'ouverture du formulaire avec:\", messageParams);\n\n//     // Méthode 1 : Essayer avec displayNewMessageForm\n//     if (typeof Office.context.mailbox.displayNewMessageForm === \"function\") {\n//       Office.context.mailbox.displayNewMessageForm(messageParams);\n//       console.log(\"Formulaire ouvert avec displayNewMessageForm\");\n//     }\n//     // Méthode 2 : Utiliser l'API REST pour composer le message\n//     else if (Office.context.mailbox.item) {\n//       composeNewMessage(to, cc, bcc, subject, messageBody);\n//     }\n//     // Méthode 3 : Fallback avec mailto\n//     else {\n//       const mailtoLink = createMailtoLink(to, cc, bcc, subject, messageBody);\n//       window.open(mailtoLink, \"_blank\");\n//       console.log(\"Formulaire ouvert avec mailto\");\n//     }\n//   } catch (error) {\n//     document.getElementById(\"error\").innerText = \"Erreur lors de l'envoi : \" + error.message;\n//     console.error(\"Erreur sendMessage:\", error);\n//   }\n// }\n\n// // Composer un nouveau message en utilisant l'API compose\n// function composeNewMessage(to, cc, bcc, subject, body) {\n//   Office.context.mailbox.item.subject.setAsync(subject);\n\n//   Office.context.mailbox.item.to.setAsync(toEmailAddressDetails(to));\n\n//   if (cc.length) {\n//     Office.context.mailbox.item.cc.setAsync(toEmailAddressDetails(cc));\n//   }\n\n//   if (bcc.length) {\n//     Office.context.mailbox.item.bcc.setAsync(toEmailAddressDetails(bcc));\n//   }\n\n//   Office.context.mailbox.item.body.setAsync(body, { coercionType: Office.CoercionType.Html });\n\n//   console.log(\"Message composé avec succès\");\n// }\n\n// // Fallback : Créer un lien mailto\n// function createMailtoLink(to, cc, bcc, subject, body) {\n//   let mailto = \"mailto:\" + to.join(\",\");\n//   const params = [];\n\n//   if (cc.length) params.push(\"cc=\" + encodeURIComponent(cc.join(\",\")));\n//   if (bcc.length) params.push(\"bcc=\" + encodeURIComponent(bcc.join(\",\")));\n//   if (subject) params.push(\"subject=\" + encodeURIComponent(subject));\n//   if (body) params.push(\"body=\" + encodeURIComponent(body.replace(/<[^>]*>/g, \"\")));\n\n//   if (params.length) {\n//     mailto += \"?\" + params.join(\"&\");\n//   }\n\n//   return mailto;\n// }\n\n// // Preparer les données à envoyer à la base de données\n// function sendToDatabase() {\n//   // Récupération des valeurs du formulaire\n//   const to = document.getElementById(\"to\").value.split(/[,;]+/).map(e => e.trim()).filter(e => e);\n//   const cc = document.getElementById(\"cc\").value.split(/[,;]+/).map(e => e.trim()).filter(e => e);\n//   const bcc = document.getElementById(\"bcc\").value.split(/[,;]+/).map(e => e.trim()).filter(e => e);\n//   const subject = document.getElementById(\"subject\").value.trim();\n//   const message_body = document.getElementById(\"message\")?.value || \"\";\n\n//   // Récupération des checkboxes sélectionnées\n//   const valeurs = Array.from(document.querySelectorAll(\".valeur:checked\")).map(cb => cb.value);\n//   const criteres = Array.from(document.querySelectorAll(\".critere:checked\")).map(cb => cb.value);\n\n//   // Récupération du nominateur\n//   const nominateur_nom = document.getElementById(\"nominateur-nom\")?.innerText || \"\";\n//   const nominateur_email = document.getElementById(\"nominateur-email\")?.innerText || \"\";\n//   const date_envoi = document.getElementById(\"date-envoi\")?.innerText || new Date().toLocaleDateString();\n\n//   // Construction de l'objet transaction\n//   const data = {\n//     to,\n//     cc,\n//     bcc,\n//     subject,\n//     message_body,\n//     valeurs,\n//     criteres,\n//     nominateur_nom,\n//     nominateur_email,\n//     // date_envoi\n//   };\n\n//   return data;\n// }\n\n// //Sauvegarde dans la base de données\n// async function saveEmail() {\n//   const data = sendToDatabase();\n\n//   try {\n//     const response = await fetch(\"http://127.0.0.1:8000/api/emails\", {\n//       method: \"POST\",\n//       headers: {\n//         \"Content-Type\": \"application/json\",\n//         \"Accept\": \"application/json\"\n//       },\n//       body: JSON.stringify(data)\n//     });\n\n//     if (!response.ok) {\n//       const err = await response.json();\n//       console.error(\"Erreur API:\", err);\n//       return;\n//     }\n\n//     const result = await response.json();\n//     console.log(\"Mail enregistré :\", result);\n//     alert(\"Mail enregistré avec succès !\");\n//   } catch (error) {\n//     console.error(\"Erreur réseau:\", error);\n//   }\n// }\n\n/**\n * Bravo & Merci - Add-in Outlook\n * Script principal du formulaire de reconnaissance\n */\n\nconst CONFIG = {\n  API_URL: \"http://127.0.0.1:8000/api/emails\",\n  EMAIL_REGEX: /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$/,\n  RH_EMAIL: \"bravo-merci@entreprise.com\",\n};\n\n// ========================================\n// Initialisation\n// ========================================\nlet isInitialized = false;\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Outlook && !isInitialized) {\n    isInitialized = true;\n    init();\n  }\n});\n\nfunction init() {\n  prefillNominateur();\n  attachEventHandlers();\n}\n\nfunction attachEventHandlers() {\n  const sendBtn = document.getElementById(\"sendBtn\");\n\n  // Retirer les anciens listeners avant d'en ajouter\n  if (sendBtn) {\n    const newBtn = sendBtn.cloneNode(true);\n    sendBtn.parentNode.replaceChild(newBtn, sendBtn);\n    newBtn.addEventListener(\"click\", handleSendMessage);\n  }\n\n  // Effacer les erreurs lors de la saisie\n  const inputs = document.querySelectorAll(\"input, textarea\");\n  inputs.forEach((input) => {\n    input.addEventListener(\"input\", clearMessages);\n  });\n}\n\n// ========================================\n// Pré-remplissage du formulaire\n// ========================================\nfunction prefillNominateur() {\n  try {\n    const user = Office.context.mailbox.userProfile;\n    const displayName = user?.displayName || \"Nom inconnu\";\n    const emailAddress = user?.emailAddress || \"email@inconnu.com\";\n\n    fillNominateurFields(displayName, emailAddress);\n  } catch (error) {\n    console.error(\"Erreur lors du pré-remplissage:\", error);\n    showError(\"Impossible de récupérer les informations utilisateur.\");\n  }\n}\n\nfunction fillNominateurFields(name, email) {\n  document.getElementById(\"nominateur-nom\").innerText = name;\n  document.getElementById(\"nominateur-email\").innerText = email;\n  document.getElementById(\"date-envoi\").innerText = new Date().toLocaleDateString(\"fr-FR\");\n}\n\n// ========================================\n// Validation des données\n// ========================================\nfunction isValidEmail(email) {\n  return CONFIG.EMAIL_REGEX.test(email);\n}\n\nfunction getInvalidEmails(emails) {\n  return emails.filter((email) => !isValidEmail(email));\n}\n\nfunction parseEmailField(fieldId) {\n  const value = document.getElementById(fieldId)?.value || \"\";\n  return value\n    .split(/[,;]+/)\n    .map((e) => e.trim())\n    .filter((e) => e);\n}\n\nfunction validateForm() {\n  const errors = [];\n\n  // Récupération des champs\n  const to = parseEmailField(\"to\");\n  const cc = parseEmailField(\"cc\");\n  const bcc = parseEmailField(\"bcc\");\n  const subject = document.getElementById(\"subject\")?.value.trim() || \"\";\n  const message = document.getElementById(\"message\")?.value.trim() || \"\";\n  const valeurs = getCheckedValues(\".valeur\");\n  const criteres = getCheckedValues(\".critere\");\n\n  // Validation des champs obligatoires\n  if (!to.length) {\n    errors.push(\"Le champ 'Destinataire(s)' est obligatoire.\");\n  }\n\n  if (!subject) {\n    errors.push(\"Le champ 'Objet' est obligatoire.\");\n  }\n\n  if (!valeurs.length) {\n    errors.push(\"Veuillez sélectionner au moins une valeur reconnue.\");\n  }\n\n  if (!criteres.length) {\n    errors.push(\"Veuillez sélectionner au moins un critère de reconnaissance.\");\n  }\n\n  if (!message) {\n    errors.push(\"Le champ 'Message' est obligatoire.\");\n  }\n\n  // Validation des emails\n  const allEmails = [...to, ...cc, ...bcc];\n  const invalidEmails = getInvalidEmails(allEmails);\n\n  if (invalidEmails.length) {\n    errors.push(`Adresse(s) email invalide(s) : ${invalidEmails.join(\", \")}`);\n  }\n\n  return {\n    isValid: errors.length === 0,\n    errors,\n    data: { to, cc, bcc, subject, message, valeurs, criteres },\n  };\n}\n\nfunction getCheckedValues(selector) {\n  return Array.from(document.querySelectorAll(`${selector}:checked`)).map((cb) => cb.value);\n}\n\n// ========================================\n// Construction du message\n// ========================================\nfunction buildMessageBody(subject = \"\", message = \"\", valeurs = [], criteres = []) {\n  const logoUrl = \"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRg-Me-63CZ3XXkow-vhNX4xV_lsFk-gYIxzA&s\";\n\n  const dateEnvoi = new Date().toLocaleDateString(\"fr-FR\");\n  let nomNominateur = \"\";\n  let emailNominateur = \"\";\n\n  if (typeof Office !== \"undefined\" && Office.context && Office.context.mailbox) {\n    const profile = Office.context.mailbox.userProfile;\n    if (profile) {\n      nomNominateur = profile.displayName || nomNominateur;\n      emailNominateur = profile.emailAddress || emailNominateur;\n    }\n  }\n  return `\n<!doctype html>\n<html lang=\"fr\">\n  <head>\n    <meta charset=\"UTF-8\" />\n    <title>Bravo & Merci</title>\n  </head>\n\n  <body style=\"margin:0;padding:0;background-color:#fff;\">\n    <div style=\"width:100%;padding:24px 0;background-color:#f3f2f1;\">\n\n      <!-- Container -->\n      <div style=\"\n        max-width:600px;\n        margin:0 auto;\n        background-color:#ffffff;\n        border-radius:4px;\n        padding:28px;\n        font-family:Segoe UI, Arial, sans-serif;\n        color:#1f1f1f;\n      \">\n\n        <!-- Header -->\n        <div style=\"margin-bottom:24px;\">\n          <img src=\"${logoUrl}\" width=\"160\" alt=\"SGCI\" />\n        </div>\n\n        <!-- Meta informations -->\n        <div style=\"\n          font-size:13px;\n          line-height:18px;\n          color:#4a4a4a;\n          margin-bottom:24px;\n          padding-left:12px;\n          border-left:3px solid #e60028;\n        \">\n          <div><strong>Date d’envoi :</strong> ${dateEnvoi}</div>\n          <div><strong>Nom du nominateur :</strong> ${nomNominateur}</div>\n          <div><strong>Email du nominateur :</strong> ${emailNominateur}</div>\n        </div>\n\n        <!-- Objet -->\n        <div style=\"margin-bottom:20px;\">\n          <div style=\"\n            font-size:12px;\n            text-transform:uppercase;\n            letter-spacing:0.4px;\n            color:#605e5c;\n            margin-bottom:6px;\n          \">\n            Objet\n          </div>\n          <div style=\"\n            font-size:17px;\n            font-weight:600;\n            line-height:22px;\n            color:#000000;\n          \">\n           ${ subject }\n          </div>\n        </div>\n\n        <!-- Divider -->\n        <div style=\"height:1px;background-color:#edebe9;margin:24px 0;\"></div>\n\n        <!-- Valeurs -->\n        ${\n          valeurs.length\n            ? `\n        <div style=\"margin-bottom:20px;\">\n          <div style=\"\n            font-size:14px;\n            font-weight:600;\n            margin-bottom:8px;\n            color:#000000;\n          \">\n            Valeur Société Générale reconnue\n          </div>\n          ${valeurs\n            .map(\n              (v) => `\n          <span style=\"\n            display:inline-block;\n            background-color:#fde7ea;\n            color:#a4001d;\n            padding:5px 12px;\n            border-radius:14px;\n            font-size:12px;\n            margin:4px 6px 0 0;\n          \">\n            ${v}\n          </span>`\n            )\n            .join(\"\")}\n        </div>`\n            : \"\"\n        }\n\n        <!-- Critères -->\n        ${\n          criteres.length\n            ? `\n        <div style=\"margin-bottom:24px;\">\n          <div style=\"\n            font-size:14px;\n            font-weight:600;\n            margin-bottom:8px;\n            color:#000000;\n          \">\n            Critère(s) de reconnaissance\n          </div>\n          ${criteres\n            .map(\n              (c) => `\n          <span style=\"\n            display:inline-block;\n            background-color:#f2f2f2;\n            color:#1f1f1f;\n            padding:5px 12px;\n            border-radius:14px;\n            font-size:12px;\n            margin:4px 6px 0 0;\n          \">\n            ${c}\n          </span>`\n            )\n            .join(\"\")}\n        </div>`\n            : \"\"\n        }\n\n        <!-- Message -->\n        <div style=\"margin-bottom:24px;\">\n          <div style=\"\n            font-size:14px;\n            font-weight:600;\n            margin-bottom:8px;\n            color:#000000;\n          \">\n            Message de reconnaissance\n          </div>\n\n          <div style=\"\n            font-size:15px;\n            line-height:22px;\n            color:#1f1f1f;\n          \">\n            ${message.replace(/\\n/g, \"<br>\")}\n          </div>\n        </div>\n\n        <!-- Footer -->\n        <div style=\"\n          border-top:1px solid #edebe9;\n          padding-top:12px;\n          font-size:11px;\n          color:#6b6b6b;\n          text-align:left;\n        \">\n          Message envoyé via le programme de reconnaissance interne SGCI.\n        </div>\n\n      </div>\n    </div>\n  </body>\n</html>\n  `;\n}\n\n// ========================================\n// Gestion de l'envoi\n// ========================================\nlet isSending = false;\n\nasync function handleSendMessage(event) {\n  event.preventDefault();\n\n  // Bloquer si déjà en cours d'envoi\n  if (isSending) {\n    return;\n  }\n\n  isSending = true;\n\n  // Nettoyer les messages précédents\n  clearMessages();\n\n  // Validation\n  const validation = validateForm();\n\n  if (!validation.isValid) {\n    showError(validation.errors.join(\"<br>\"));\n    isSending = false;\n    return;\n  }\n\n  // Afficher le loader\n  setLoading(true);\n\n  try {\n    const { to, cc, bcc, subject, message, valeurs, criteres } = validation.data;\n\n    // Ajouter l'email RH en CCI automatiquement\n    const bccWithRH = [...bcc];\n    if (CONFIG.RH_EMAIL && !bccWithRH.includes(CONFIG.RH_EMAIL)) {\n      bccWithRH.push(CONFIG.RH_EMAIL);\n    }\n\n    // Construire le corps du message\n    htmlBody = buildMessageBody(subject, message, valeurs, criteres);\n\n    // Préparer les données pour la BDD\n    const dbData = prepareDataForDatabase(to, cc, bccWithRH, subject, message, valeurs, criteres);\n\n    // Ouvrir le formulaire de composition Outlook\n    const messageParams = {\n      toRecipients: toEmailAddressDetails(to),\n      ccRecipients: cc.length ? toEmailAddressDetails(cc) : undefined,\n      bccRecipients: bccWithRH.length ? toEmailAddressDetails(bccWithRH) : undefined,\n      subject: subject,\n      htmlBody: htmlBody,\n    };\n\n    // Envoyer à Outlook\n    await openOutlookCompose(messageParams);\n\n    // Sauvegarder en BDD (après ouverture du formulaire)\n    await saveToDatabase(dbData);\n\n    // Succès\n    showSuccess(\"Reconnaissance envoyée avec succès ! Le message a été sauvegardé.\");\n\n    // Réinitialiser le formulaire après 2 secondes\n    setTimeout(() => {\n      resetForm();\n      isSending = false;\n    }, 2000);\n  } catch (error) {\n    showError(`Erreur lors de l'envoi : ${error.message}`);\n    isSending = false;\n  } finally {\n    setLoading(false);\n  }\n}\n\n// ========================================\n// Interaction avec Outlook\n// ========================================\nfunction toEmailAddressDetails(emails) {\n  return emails.map((email) => ({\n    emailAddress: email,\n    displayName: email,\n  }));\n}\n\nasync function openOutlookCompose(messageParams) {\n  return new Promise((resolve, reject) => {\n    try {\n      // Méthode 1 : displayNewMessageForm (préférée)\n      if (typeof Office.context.mailbox.displayNewMessageForm === \"function\") {\n        Office.context.mailbox.displayNewMessageForm(messageParams);\n        resolve();\n      }\n      // Méthode 2 : Composer dans le contexte actuel\n      else if (Office.context.mailbox.item) {\n        composeInCurrentContext(messageParams);\n        resolve();\n      }\n      // Méthode 3 : Fallback mailto\n      else {\n        const mailtoUrl = createMailtoUrl(messageParams);\n        window.open(mailtoUrl, \"_blank\");\n        resolve();\n      }\n    } catch (error) {\n      reject(new Error(`Impossible d'ouvrir le formulaire Outlook : ${error.message}`));\n    }\n  });\n}\n\nfunction composeInCurrentContext(params) {\n  const item = Office.context.mailbox.item;\n\n  if (params.subject) {\n    item.subject.setAsync(params.subject);\n  }\n\n  if (params.toRecipients) {\n    item.to.setAsync(params.toRecipients);\n  }\n\n  if (params.ccRecipients) {\n    item.cc.setAsync(params.ccRecipients);\n  }\n\n  if (params.bccRecipients) {\n    item.bcc.setAsync(params.bccRecipients);\n  }\n\n  if (params.htmlBody) {\n    item.body.setAsync(params.htmlBody, { coercionType: Office.CoercionType.Html });\n  }\n}\n\nfunction createMailtoUrl(params) {\n  const to = params.toRecipients?.map((r) => r.emailAddress).join(\",\") || \"\";\n  let mailto = `mailto:${to}`;\n  const queryParams = [];\n\n  if (params.ccRecipients?.length) {\n    const cc = params.ccRecipients.map((r) => r.emailAddress).join(\",\");\n    queryParams.push(`cc=${encodeURIComponent(cc)}`);\n  }\n\n  if (params.bccRecipients?.length) {\n    const bcc = params.bccRecipients.map((r) => r.emailAddress).join(\",\");\n    queryParams.push(`bcc=${encodeURIComponent(bcc)}`);\n  }\n\n  if (params.subject) {\n    queryParams.push(`subject=${encodeURIComponent(params.subject)}`);\n  }\n\n  if (params.htmlBody) {\n    const plainText = params.htmlBody.replace(/<[^>]*>/g, \"\");\n    queryParams.push(`body=${encodeURIComponent(plainText)}`);\n  }\n\n  if (queryParams.length) {\n    mailto += `?${queryParams.join(\"&\")}`;\n  }\n\n  return mailto;\n}\n\n// ========================================\n// Sauvegarde en base de données\n// ========================================\nfunction prepareDataForDatabase(to, cc, bcc, subject, message, valeurs, criteres) {\n  const nominateurNom = document.getElementById(\"nominateur-nom\")?.innerText || \"\";\n  const nominateurEmail = document.getElementById(\"nominateur-email\")?.innerText || \"\";\n  // const dateEnvoi = new Date().toISOString();\n\n  return {\n    nominateur_nom: nominateurNom,\n    nominateur_email: nominateurEmail,\n    // date_envoi: dateEnvoi,\n    to: to,\n    cc: cc,\n    bcc: bcc,\n    subject: subject,\n    message_body: message,\n    valeurs: valeurs,\n    criteres: criteres,\n  };\n}\n\nasync function saveToDatabase(data) {\n  try {\n    const response = await fetch(CONFIG.API_URL, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n      },\n      body: JSON.stringify(data),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({}));\n      throw new Error(errorData.message || `Erreur API : ${response.status}`);\n    }\n\n    const result = await response.json();\n    console.log(\"Données sauvegardées dans la BD:\", result);\n    return result;\n  } catch (error) {\n    console.error(\"Erreur lors de la sauvegarde en BD:\", error);\n    // Note : On ne bloque pas l'envoi si la BDD échoue\n    throw new Error(`Sauvegarde en base de données échouée : ${error.message}`);\n  }\n}\n\n// ========================================\n// UI - Messages et états\n// ========================================\nfunction showError(message) {\n  const errorEl = document.getElementById(\"error\");\n  if (errorEl) {\n    errorEl.innerHTML = message;\n    errorEl.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\n  }\n}\n\nfunction showSuccess(message) {\n  const successEl = document.getElementById(\"success\");\n  if (successEl) {\n    successEl.innerText = message;\n    successEl.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\n  }\n}\n\nfunction clearMessages() {\n  const errorEl = document.getElementById(\"error\");\n  const successEl = document.getElementById(\"success\");\n\n  if (errorEl) errorEl.innerHTML = \"\";\n  if (successEl) successEl.innerText = \"\";\n}\n\nfunction setLoading(isLoading) {\n  const btn = document.getElementById(\"sendBtn\");\n\n  if (!btn) return;\n\n  if (isLoading) {\n    btn.disabled = true;\n    btn.classList.add(\"loading\");\n    btn.innerHTML = '<span class=\"ms-Button-label\">Envoi en cours...</span>';\n  } else {\n    btn.disabled = false;\n    btn.classList.remove(\"loading\");\n    btn.innerHTML = '<span class=\"ms-Button-label\">Envoyer la reconnaissance</span>';\n  }\n}\n\nfunction resetForm() {\n  // Réinitialiser tous les champs sauf le nominateur\n  document.getElementById(\"to\").value = \"\";\n  document.getElementById(\"cc\").value = \"\";\n  document.getElementById(\"bcc\").value = \"\";\n  document.getElementById(\"subject\").value = \"\";\n  document.getElementById(\"message\").value = \"\";\n\n  // Décocher toutes les checkboxes\n  document.querySelectorAll(\".valeur, .critere\").forEach((cb) => {\n    cb.checked = false;\n  });\n\n  clearMessages();\n}\n\n// ========================================\n// Utilitaires de debug (optionnel)\n// ========================================\nfunction showDebug(message) {\n  const debugEl = document.getElementById(\"debugOutput\");\n  if (debugEl) {\n    const timestamp = new Date().toLocaleTimeString();\n    debugEl.textContent += `[${timestamp}] ${message}\\n`;\n  }\n}\n\n// // ========================================\n// // Configuration Microsoft Graph\n// // ========================================\n// const GRAPH_CONFIG = {\n//   clientId: \"1eafde30-d8fe-4eac-9a7b-8c0026f960fc\",\n//   tenantId: \"901cb4ca-b862-4029-9306-e5cd0f6d9f86\",\n\n//   // Permissions nécessaires\n//   scopes: [\"User.Read\", \"Mail.Send\"],\n\n//   // Endpoints\n//   graphEndpoint: \"https://graph.microsoft.com/v1.0/me/sendMail\"\n// };\n\n// // Variables globales pour l'authentification\n// let msalInstance = null;\n// let currentAccount = null;\n\n// // ========================================\n// // Initialisation MSAL\n// // ========================================\n// function initializeMSAL() {\n//   const msalConfig = {\n//     auth: {\n//       clientId: GRAPH_CONFIG.clientId,\n//       authority: `https://login.microsoftonline.com/${GRAPH_CONFIG.tenantId}`,\n//       redirectUri: window.location.origin\n//     },\n//     cache: {\n//       cacheLocation: \"localStorage\",\n//       storeAuthStateInCookie: false\n//     }\n//   };\n\n//   msalInstance = new msal.PublicClientApplication(msalConfig);\n\n//   // Gérer les redirections après authentification\n//   msalInstance.handleRedirectPromise()\n//     .then(response => {\n//       if (response) {\n//         currentAccount = response.account;\n//         console.log(\"Authentification réussie:\", currentAccount.username);\n//       } else {\n//         const accounts = msalInstance.getAllAccounts();\n//         if (accounts.length > 0) {\n//           currentAccount = accounts[0];\n//           console.log(\"Compte existant trouvé:\", currentAccount.username);\n//         }\n//       }\n//     })\n//     .catch(error => {\n//       console.error(\"Erreur lors de la gestion de la redirection:\", error);\n//     });\n// }\n\n// // ========================================\n// // Authentification Microsoft\n// // ========================================\n// async function getAccessToken() {\n//   if (!msalInstance) {\n//     throw new Error(\"MSAL n'est pas initialisé\");\n//   }\n\n//   const accounts = msalInstance.getAllAccounts();\n\n//   if (accounts.length === 0) {\n//     // Aucun compte connecté, demander connexion\n//     return await loginWithPopup();\n//   }\n\n//   // Tentative d'acquisition silencieuse du token\n//   const account = accounts[0];\n//   const silentRequest = {\n//     scopes: GRAPH_CONFIG.scopes,\n//     account: account\n//   };\n\n//   try {\n//     const response = await msalInstance.acquireTokenSilent(silentRequest);\n//     return response.accessToken;\n//   } catch (error) {\n//     console.log(\"Token silencieux échoué, popup requise:\", error);\n//     // Si le token silencieux échoue, demander connexion popup\n//     return await loginWithPopup();\n//   }\n// }\n\n// async function loginWithPopup() {\n//   const loginRequest = {\n//     scopes: GRAPH_CONFIG.scopes,\n//     prompt: \"select_account\"\n//   };\n\n//   try {\n//     const response = await msalInstance.loginPopup(loginRequest);\n//     currentAccount = response.account;\n//     return response.accessToken;\n//   } catch (error) {\n//     console.error(\"Erreur lors de la connexion popup:\", error);\n//     throw new Error(\"Impossible de se connecter à Microsoft. Veuillez réessayer.\");\n//   }\n// }\n\n// // ========================================\n// // Envoi d'email via Microsoft Graph\n// // ========================================\n// async function sendEmailViaGraph(emailParams) {\n//   try {\n//     // Obtenir un token d'accès valide\n//     const accessToken = await getAccessToken();\n\n//     // Construire le payload au format Microsoft Graph\n//     const emailPayload = {\n//       message: {\n//         subject: emailParams.subject,\n//         body: {\n//           contentType: \"HTML\",\n//           content: emailParams.htmlBody\n//         },\n//         toRecipients: emailParams.toRecipients.map(r => ({\n//           emailAddress: {\n//             address: r.emailAddress,\n//             name: r.displayName || r.emailAddress\n//           }\n//         })),\n//         ccRecipients: (emailParams.ccRecipients || []).map(r => ({\n//           emailAddress: {\n//             address: r.emailAddress,\n//             name: r.displayName || r.emailAddress\n//           }\n//         })),\n//         bccRecipients: (emailParams.bccRecipients || []).map(r => ({\n//           emailAddress: {\n//             address: r.emailAddress,\n//             name: r.displayName || r.emailAddress\n//           }\n//         }))\n//       },\n//       saveToSentItems: true\n//     };\n\n//     // Appel à l'API Microsoft Graph\n//     const response = await fetch(GRAPH_CONFIG.graphEndpoint, {\n//       method: \"POST\",\n//       headers: {\n//         \"Authorization\": `Bearer ${accessToken}`,\n//         \"Content-Type\": \"application/json\"\n//       },\n//       body: JSON.stringify(emailPayload)\n//     });\n\n//     if (!response.ok) {\n//       const errorData = await response.json().catch(() => ({}));\n//       const errorMessage = errorData.error?.message || `Erreur HTTP ${response.status}`;\n//       throw new Error(errorMessage);\n//     }\n\n//     // L'API Graph retourne 202 Accepted sans body\n//     return {\n//       success: true,\n//       message: \"Email envoyé avec succès\"\n//     };\n\n//   } catch (error) {\n//     console.error(\"Erreur lors de l'envoi via Microsoft Graph:\", error);\n//     throw error;\n//   }\n// }\n\n// // ========================================\n// // Initialisation Office\n// // ========================================\n// Office.onReady((info) => {\n//   if (info.host === Office.HostType.Outlook) {\n//     // Initialiser MSAL en premier\n//     initializeMSAL();\n\n//     // Initialiser le reste de l'application\n//     init();\n//   }\n// });\n\n// function init() {\n//   prefillNominateur();\n//   attachEventHandlers();\n// }\n\n// function attachEventHandlers() {\n//   document.getElementById(\"sendBtn\").addEventListener(\"click\", handleSendMessage);\n\n//   // Effacer les erreurs lors de la saisie\n//   const inputs = document.querySelectorAll(\"input, textarea\");\n//   inputs.forEach(input => {\n//     input.addEventListener(\"input\", clearMessages);\n//   });\n// }\n\n// // ========================================\n// // Pré-remplissage du formulaire\n// // ========================================\n// function prefillNominateur() {\n//   try {\n//     const user = Office.context.mailbox.userProfile;\n//     const displayName = user?.displayName || \"Nom inconnu\";\n//     const emailAddress = user?.emailAddress || \"email@inconnu.com\";\n\n//     fillNominateurFields(displayName, emailAddress);\n//   } catch (error) {\n//     console.error(\"Erreur lors du pré-remplissage:\", error);\n//     showError(\"Impossible de récupérer les informations utilisateur.\");\n//   }\n// }\n\n// function fillNominateurFields(name, email) {\n//   document.getElementById(\"nominateur-nom\").innerText = name;\n//   document.getElementById(\"nominateur-email\").innerText = email;\n//   document.getElementById(\"date-envoi\").innerText = new Date().toLocaleDateString(\"fr-FR\");\n// }\n\n// // ========================================\n// // Validation des données\n// // ========================================\n// function isValidEmail(email) {\n//   return CONFIG.EMAIL_REGEX.test(email);\n// }\n\n// function getInvalidEmails(emails) {\n//   return emails.filter(email => !isValidEmail(email));\n// }\n\n// function parseEmailField(fieldId) {\n//   const value = document.getElementById(fieldId)?.value || \"\";\n//   return value\n//     .split(/[,;]+/)\n//     .map(e => e.trim())\n//     .filter(e => e);\n// }\n\n// function validateForm() {\n//   const errors = [];\n\n//   // Récupération des champs\n//   const to = parseEmailField(\"to\");\n//   const cc = parseEmailField(\"cc\");\n//   const bcc = parseEmailField(\"bcc\");\n//   const subject = document.getElementById(\"subject\")?.value.trim() || \"\";\n//   const message = document.getElementById(\"message\")?.value.trim() || \"\";\n//   const valeurs = getCheckedValues(\".valeur\");\n//   const criteres = getCheckedValues(\".critere\");\n\n//   // Validation des champs obligatoires\n//   if (!to.length) {\n//     errors.push(\"Le champ 'Destinataire(s)' est obligatoire.\");\n//   }\n\n//   if (!subject) {\n//     errors.push(\"Le champ 'Objet' est obligatoire.\");\n//   }\n\n//   if (!valeurs.length) {\n//     errors.push(\"Veuillez sélectionner au moins une valeur reconnue.\");\n//   }\n\n//   if (!criteres.length) {\n//     errors.push(\"Veuillez sélectionner au moins un critère de reconnaissance.\");\n//   }\n\n//   if (!message) {\n//     errors.push(\"Le champ 'Message' est obligatoire.\");\n//   }\n\n//   // Validation des emails\n//   const allEmails = [...to, ...cc, ...bcc];\n//   const invalidEmails = getInvalidEmails(allEmails);\n\n//   if (invalidEmails.length) {\n//     errors.push(`Adresse(s) email invalide(s) : ${invalidEmails.join(\", \")}`);\n//   }\n\n//   return {\n//     isValid: errors.length === 0,\n//     errors,\n//     data: { to, cc, bcc, subject, message, valeurs, criteres }\n//   };\n// }\n\n// function getCheckedValues(selector) {\n//   return Array.from(document.querySelectorAll(`${selector}:checked`))\n//     .map(cb => cb.value);\n// }\n\n// // ========================================\n// // Construction du message\n// // ========================================\n// function buildMessageBody(message, valeurs, criteres) {\n//   let body = \"<div style='font-family: Segoe UI, sans-serif;'>\";\n\n//   if (valeurs.length) {\n//     body += `<p><strong>Valeurs reconnues :</strong><br>${valeurs.join(\", \")}</p>`;\n//   }\n\n//   if (criteres.length) {\n//     body += `<p><strong>Critères :</strong><br>${criteres.join(\", \")}</p>`;\n//   }\n\n//   body += `<hr style='border: none; border-top: 1px solid #edebe9; margin: 16px 0;'>`;\n//   body += `<p>${message.replace(/\\n/g, \"<br>\")}</p>`;\n//   body += \"</div>\";\n\n//   return body;\n// }\n\n// // ========================================\n// // Gestion de l'envoi (NOUVELLE LOGIQUE)\n// // ========================================\n// async function handleSendMessage(event) {\n//   event.preventDefault();\n\n//   // Nettoyer les messages précédents\n//   clearMessages();\n\n//   // Validation\n//   const validation = validateForm();\n\n//   if (!validation.isValid) {\n//     showError(validation.errors.join(\"<br>\"));\n//     return;\n//   }\n\n//   // Afficher le loader\n//   setLoading(true);\n\n//   try {\n//     const { to, cc, bcc, subject, message, valeurs, criteres } = validation.data;\n\n//     // Ajouter l'email RH en CCI automatiquement\n//     const bccWithRH = [...bcc];\n//     if (CONFIG.RH_EMAIL && !bccWithRH.includes(CONFIG.RH_EMAIL)) {\n//       bccWithRH.push(CONFIG.RH_EMAIL);\n//     }\n\n//     // Construire le corps du message HTML\n//     const htmlBody = buildMessageBody(message, valeurs, criteres);\n\n//     // Préparer les paramètres pour Microsoft Graph\n//     const emailParams = {\n//       toRecipients: toEmailAddressDetails(to),\n//       ccRecipients: cc.length ? toEmailAddressDetails(cc) : [],\n//       bccRecipients: bccWithRH.length ? toEmailAddressDetails(bccWithRH) : [],\n//       subject: subject,\n//       htmlBody: htmlBody\n//     };\n\n//     // ENVOI AUTOMATIQUE via Microsoft Graph API\n//     await sendEmailViaGraph(emailParams);\n\n//     // Préparer les données pour la BDD\n//     const dbData = prepareDataForDatabase(to, cc, bccWithRH, subject, message, valeurs, criteres);\n\n//     // Sauvegarder en BDD après envoi réussi\n//     await saveToDatabase(dbData);\n\n//     // Succès\n//     showSuccess(\"Email envoyé automatiquement et sauvegardé avec succès !\");\n\n//     // Réinitialiser le formulaire après 2 secondes\n//     setTimeout(resetForm, 2000);\n\n//   } catch (error) {\n//     console.error(\"Erreur lors de l'envoi:\", error);\n\n//     // Messages d'erreur plus détaillés\n//     let errorMessage = \"Erreur lors de l'envoi : \";\n\n//     if (error.message.includes(\"MSAL\")) {\n//       errorMessage += \"Problème d'authentification Microsoft. Veuillez vous reconnecter.\";\n//     } else if (error.message.includes(\"MailboxNotEnabledForRESTAPI\")) {\n//       errorMessage += \"Votre boîte mail n'est pas configurée pour l'API. Contactez votre administrateur.\";\n//     } else if (error.message.includes(\"InvalidAuthenticationToken\")) {\n//       errorMessage += \"Session expirée. Veuillez rafraîchir la page.\";\n//     } else {\n//       errorMessage += error.message;\n//     }\n\n//     showError(errorMessage);\n//   } finally {\n//     setLoading(false);\n//   }\n// }\n\n// // ========================================\n// // Utilitaire de conversion d'emails\n// // ========================================\n// function toEmailAddressDetails(emails) {\n//   return emails.map(email => ({\n//     emailAddress: email,\n//     displayName: email\n//   }));\n// }\n\n// // ========================================\n// // Sauvegarde en base de données\n// // ========================================\n// function prepareDataForDatabase(to, cc, bcc, subject, message, valeurs, criteres) {\n//   const nominateurNom = document.getElementById(\"nominateur-nom\")?.innerText || \"\";\n//   const nominateurEmail = document.getElementById(\"nominateur-email\")?.innerText || \"\";\n\n//   return {\n//     nominateur_nom: nominateurNom,\n//     nominateur_email: nominateurEmail,\n//     to: to,\n//     cc: cc,\n//     bcc: bcc,\n//     subject: subject,\n//     message_body: message,\n//     valeurs: valeurs,\n//     criteres: criteres\n//   };\n// }\n\n// async function saveToDatabase(data) {\n//   try {\n//     const response = await fetch(CONFIG.API_URL, {\n//       method: \"POST\",\n//       headers: {\n//         \"Content-Type\": \"application/json\",\n//         \"Accept\": \"application/json\"\n//       },\n//       body: JSON.stringify(data)\n//     });\n\n//     if (!response.ok) {\n//       const errorData = await response.json().catch(() => ({}));\n//       throw new Error(errorData.message || `Erreur API : ${response.status}`);\n//     }\n\n//     const result = await response.json();\n//     console.log(\"Données sauvegardées dans la BD:\", result);\n//     return result;\n\n//   } catch (error) {\n//     console.error(\"Erreur lors de la sauvegarde en BD:\", error);\n//     // Note : On affiche un warning mais on ne bloque pas l'envoi\n//     console.warn(\"L'email a été envoyé mais n'a pas pu être sauvegardé en base de données\");\n//     throw error;\n//   }\n// }\n\n// // ========================================\n// // UI - Messages et états\n// // ========================================\n// function showError(message) {\n//   const errorEl = document.getElementById(\"error\");\n//   if (errorEl) {\n//     errorEl.innerHTML = message;\n//     errorEl.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\n//   }\n// }\n\n// function showSuccess(message) {\n//   const successEl = document.getElementById(\"success\");\n//   if (successEl) {\n//     successEl.innerText = message;\n//     successEl.scrollIntoView({ behavior: \"smooth\", block: \"nearest\" });\n//   }\n// }\n\n// function clearMessages() {\n//   const errorEl = document.getElementById(\"error\");\n//   const successEl = document.getElementById(\"success\");\n\n//   if (errorEl) errorEl.innerHTML = \"\";\n//   if (successEl) successEl.innerText = \"\";\n// }\n\n// function setLoading(isLoading) {\n//   const btn = document.getElementById(\"sendBtn\");\n\n//   if (!btn) return;\n\n//   if (isLoading) {\n//     btn.disabled = true;\n//     btn.classList.add(\"loading\");\n//     btn.innerHTML = '<span class=\"ms-Button-label\">Envoi en cours...</span>';\n//   } else {\n//     btn.disabled = false;\n//     btn.classList.remove(\"loading\");\n//     btn.innerHTML = '<span class=\"ms-Button-label\">Envoyer la reconnaissance</span>';\n//   }\n// }\n\n// function resetForm() {\n//   // Réinitialiser tous les champs sauf le nominateur\n//   document.getElementById(\"to\").value = \"\";\n//   document.getElementById(\"cc\").value = \"\";\n//   document.getElementById(\"bcc\").value = \"\";\n//   document.getElementById(\"subject\").value = \"\";\n//   document.getElementById(\"message\").value = \"\";\n\n//   // Décocher toutes les checkboxes\n//   document.querySelectorAll(\".valeur, .critere\").forEach(cb => {\n//     cb.checked = false;\n//   });\n\n//   clearMessages();\n// }\n\n// // ========================================\n// // Utilitaires de debug (optionnel)\n// // ========================================\n// function showDebug(message) {\n//   const debugEl = document.getElementById(\"debugOutput\");\n//   if (debugEl) {\n//     const timestamp = new Date().toLocaleTimeString();\n//     debugEl.textContent += `[${timestamp}] ${message}\\n`;\n//   }\n// }\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!doctype html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>Bravo & Merci</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body> <main class=\\\"ms-welcome\\\"> <hr/> <section class=\\\"nominateur-section\\\"> <h3 class=\\\"ms-font-l\\\">Nominateur</h3> <p><strong>Nom :</strong> <span id=\\\"nominateur-nom\\\">Chargement...</span></p> <p><strong>Email :</strong> <span id=\\\"nominateur-email\\\">Chargement...</span></p> <p><strong>Date :</strong> <span id=\\\"date-envoi\\\"></span></p> </section> <hr/> <section class=\\\"reconnaissance-section\\\"> <h3 class=\\\"ms-font-l\\\">Reconnaissance</h3> <div class=\\\"form-group\\\"> <label for=\\\"to\\\">Destinataire(s) <span class=\\\"required\\\">*</span></label> <input type=\\\"text\\\" id=\\\"to\\\" placeholder=\\\"email@entreprise.com (séparez par des virgules)\\\"/> <small class=\\\"help-text\\\">Séparez plusieurs emails par des virgules</small> </div> <div class=\\\"form-group\\\"> <label for=\\\"cc\\\">CC</label> <input type=\\\"text\\\" id=\\\"cc\\\" placeholder=\\\"email@entreprise.com (optionnel)\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"bcc\\\">CCI</label> <input type=\\\"text\\\" id=\\\"bcc\\\" placeholder=\\\"email@entreprise.com (optionnel)\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"subject\\\">Objet <span class=\\\"required\\\">*</span></label> <input type=\\\"text\\\" id=\\\"subject\\\" placeholder=\\\"Bravo pour...\\\"/> </div> <div class=\\\"form-group\\\"> <h4 class=\\\"ms-font-m\\\">Valeurs reconnues <span class=\\\"required\\\">*</span></h4> <div class=\\\"checkbox-group\\\"> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Esprit d'Équipe\\\" class=\\\"valeur\\\"/> <strong>Esprit d'Équipe</strong> <span class=\\\"value-description\\\">Sentiment de faire corps ; Intérêt pour l'objectif partagé ; Implication dans la réussite collective.</span> </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Responsabilité\\\" class=\\\"valeur\\\"/> <strong>Responsabilité</strong> <span class=\\\"value-description\\\">Adoption des règles et principes d'Ethique, de déontologie, de morale.</span> </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Engagement\\\" class=\\\"valeur\\\"/> <strong>Engagement</strong> <span class=\\\"value-description\\\">Motivation intrinsèque ; Intégrité personnelle ; Altruisme, sensibilité, souci des autres ; Autonomie de pensée et d'action ; Sens de l'éthique.</span> </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Innovation\\\" class=\\\"valeur\\\"/> <strong>Innovation</strong> <span class=\\\"value-description\\\">Améliorations radicales (nouvelles) ou continues ; Nouvelles idées approuvées.</span> </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Leadership Exemplaire\\\" class=\\\"valeur\\\"/> <strong>Leadership Exemplaire</strong> <span class=\\\"value-description\\\">Capacité de guider, d'influencer et d'inspirer ; Capacité à mobiliser autrui vers l'atteinte d'objectifs ambitieux.</span> </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Expérience Client\\\" class=\\\"valeur\\\"/> <strong>Expérience Client (Interne/Externe)</strong> <span class=\\\"value-description\\\">Engagement client ; Satisfaction client ; Orientation client ; Amélioration de la relation client ; Actions de fidélisation.</span> </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Efficacité Opérationnelle\\\" class=\\\"valeur\\\"/> <strong>Efficacité Opérationnelle</strong> <span class=\\\"value-description\\\">Gestion des coûts ; Efficacité des processus.</span> </label> </div> </div> <div class=\\\"form-group\\\"> <h4 class=\\\"ms-font-m\\\">Critères de reconnaissance <span class=\\\"required\\\">*</span></h4> <div class=\\\"checkbox-group checkbox-inline\\\"> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Merci\\\" class=\\\"critere\\\"/> Merci </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Bon travail\\\" class=\\\"critere\\\"/> Bon travail </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Impressionnant\\\" class=\\\"critere\\\"/> Impressionnant </label> <label class=\\\"checkbox-label\\\"> <input type=\\\"checkbox\\\" value=\\\"Exceptionnel\\\" class=\\\"critere\\\"/> Exceptionnel </label> </div> </div> <div class=\\\"form-group\\\"> <label for=\\\"message\\\">Message <span class=\\\"required\\\">*</span></label> <textarea id=\\\"message\\\" rows=\\\"5\\\" placeholder=\\\"Votre message de reconnaissance...\\\"></textarea> </div> <div class=\\\"form-actions\\\"> <button id=\\\"sendBtn\\\" class=\\\"ms-Button ms-Button--primary\\\"> <span class=\\\"ms-Button-label\\\">Envoyer la reconnaissance</span> </button> </div> <div id=\\\"messageContainer\\\"> <p id=\\\"error\\\" class=\\\"message-error\\\"></p> <p id=\\\"success\\\" class=\\\"message-success\\\"></p> </div> </section> </main> <\" + \"script src=\\\"https://alcdn.msauth.net/browser/2.32.2/js/msal-browser.min.js\\\"><\" + \"/script> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","_toConsumableArray","Array","isArray","_arrayLikeToArray","_arrayWithoutHoles","from","_iterableToArray","toString","slice","constructor","name","_unsupportedIterableToArray","_nonIterableSpread","CONFIG","API_URL","EMAIL_REGEX","RH_EMAIL","isInitialized","parseEmailField","fieldId","_document$getElementB","getElementById","split","map","trim","filter","validateForm","_document$getElementB2","_document$getElementB3","errors","to","cc","bcc","subject","message","valeurs","getCheckedValues","criteres","push","invalidEmails","concat","email","isValidEmail","join","isValid","data","selector","querySelectorAll","cb","buildMessageBody","dateEnvoi","Date","toLocaleDateString","nomNominateur","emailNominateur","Office","context","mailbox","profile","userProfile","emailAddress","onReady","info","host","HostType","Outlook","user","innerText","error","console","showError","prefillNominateur","sendBtn","newBtn","cloneNode","parentNode","replaceChild","addEventListener","handleSendMessage","forEach","input","clearMessages","attachEventHandlers","isSending","_x","_handleSendMessage","_callee","event","validation","_validation$data","bccWithRH","dbData","messageParams","_t","_context","preventDefault","setLoading","includes","htmlBody","prepareDataForDatabase","toRecipients","toEmailAddressDetails","ccRecipients","bccRecipients","openOutlookCompose","saveToDatabase","showSuccess","setTimeout","checked","emails","_x2","_openOutlookCompose","_callee2","_context2","reject","displayNewMessageForm","item","params","setAsync","body","coercionType","CoercionType","Html","mailtoUrl","createMailtoUrl","open","_params$toRecipients","_params$ccRecipients","_params$bccRecipients","mailto","queryParams","encodeURIComponent","plainText","_document$getElementB4","_document$getElementB5","nominateur_nom","nominateur_email","message_body","_x3","_saveToDatabase","_callee3","response","errorData","result","_t2","_context3","fetch","method","headers","Accept","JSON","stringify","ok","json","catch","status","log","errorEl","innerHTML","scrollIntoView","behavior","block","successEl","isLoading","btn","disabled","classList","add","remove","URL"],"ignoreList":[],"sourceRoot":""}